//////////////////////////////////////////////////////////////////////////////////////////
//                                                                                      //
//                   (C) VESTA 2020 - Planbureau voor de Leefomgeving                   //
//                                                                                      //
//////////////////////////////////////////////////////////////////////////////////////////

container Kengetallen: Using = "Units;Geography", FreeData = "False"
{
	#include<Bebouwing.dms>
	#include<WarmteBronnen.dms>
	#include<Leercurves.dms>
	#include<Infra.dms>
	#include<BCkentallen.dms>
	#include<H2kentallen.dms>

	container src
	{
		unit<uint32> BC_Kentallen: 		StorageName = "%projDir%/data/kentallen/20241015_BC_kentallen.csv", 	StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> Efficiency: 		StorageName = "%projDir%/data/kentallen/20241015_Efficiency.csv", 		StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> H2_Kentallen: 		StorageName = "%projDir%/data/kentallen/20241015_H2_Kentallen.csv", 	StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> H2_Prijzen: 		StorageName = "%projDir%/data/kentallen/20241015_H2_Prijzen.csv", 		StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> Infra: 			StorageName = "%projDir%/data/kentallen/20241015_Infra.csv", 			StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> LT_Warmtenetten: 	StorageName = "%projDir%/data/kentallen/20241015_LT_Warmtenetten.csv", 	StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> MT_Warmtenetten: 	StorageName = "%projDir%/data/kentallen/20241015_MT_Warmtenetten.csv", 	StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> Netbeheer: 		StorageName = "%projDir%/data/kentallen/20241015_Netbeheer.csv", 		StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> NMDA_Prijzen: 		StorageName = "%projDir%/data/kentallen/20241015_NMDA_Prijzen.csv", 	StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> Onderhoud: 		StorageName = "%projDir%/data/kentallen/20241015_Onderhoud.csv", 		StorageType = "gdal.vect", StorageReadOnly = "True";
		unit<uint32> Vermogens: 		StorageName = "%projDir%/data/kentallen/20241015_Vermogens.csv", 		StorageType = "gdal.vect", StorageReadOnly = "True";
	}
	container Constanten
	{
		parameter<GJ_m3>     GasEnergie             :=    31.65[MJ / m3] / 1000[MJ / GJ] , Descr = "energieinhoud laagcalorisch gas";
		parameter<GJ_m3>     GasEnergie_max         :=    35.17[MJ / m3] / 1000[MJ / GJ] , Descr = "bovengrens hoogcalorisch, rekening houdend met eficientere verbranding (o.a. condensatiewarmte van waterdamp)";
		parameter<kWh_yr_m2> Opbr_zonPV_kWh         :=   150.0 [Kwh_yr_m2]               , Descr = "opbrengst zonnepanelen per m2 in kwh";
		parameter<GJ_yr_m2>  Opbr_zonPV_GJ          := Opbr_zonPV_kWh * 0.0036[GJ / kwh] , Descr = "opbrengst zonnepanelen per m2 in gj";
		parameter<GJ_yr_m2>  Opbr_zonB_GJ           :=     1.5 [Gj_yr_m2]                , Descr = "opbrengst zonneboiler per m2 in gj";
		parameter<m>         L_max_TEObron          :=  5000   [m]                       , Descr = "maximale afstand tot geschikt oppervlaktewater voor TEO bron";
		parameter<m>         L_max_bron_connectie   :=  8000   [m]                       , Descr = "Afzonderlijke aantakkingen aan een bron-cluster LTnetten mogen niet langer dan dit zijn. Bij een T aansluiting op al gekozen telt alleen de lengte van de nieuwe poot.";
		parameter<kw>        P_target_LTbron        := 16000   [kw]                      , Descr = "doel voor gezamenlijke capaciteit bij bronclustering in LT puntbronnen";
		parameter<ratio>     afschrijving_resterend :=     1.0 / 3.0                     , Descr = "resterende afschijving op te verwijderen gasketels";
		parameter<m_asl>     L_di_gem               :=    15   [m_asl]                   , Descr = "Gemiddelde aantal meter aansluiting leiding/kabel/buis voor inschattingen van ontbrekende data", Source = "FO, nummer voetnoot 31 onder F80";
		parameter<ratio>     Omwegfactor            :=     1.25                          , Descr = "";
		parameter<kW_OS>     Vermogen_OS            :=   825   [kW_OS]                   , Descr = "";
		parameter<ratio>     Efficiency_EA          :=     1.0 [ratio]                   , Descr = "Efficiency van elektriciteitsverbruik in elektrische apparatuur als verhouding metervraag tot functionele vraag";
	}
	
	#include<MTkentallen.dms>
	#include<LTkentallen.dms>
	
	container Efficiency :=
	for_each_nedvn(
		 src/Efficiency/Naam
		,src/Efficiency/waarde+"[" + src/Efficiency/eenheid + "]"
		, void
		, src/Efficiency
		, src/Efficiency/eenheid
	), StorageReadOnly = "True"
	{
		template EfficiencyKentallen
		{
			//begin case parameters
			parameter<ratio> EfficiencySchuif;
			//end case parameters

			parameter<ratio> Eff_min := 1d - EfficiencySchuif;
			parameter<ratio> Eff_max := EfficiencySchuif;
	
			parameter<GJe_GJth> V_elek_WKO                := Eff_min * Efficiency/V_elek_WKO_min           + Eff_max * Efficiency/V_elek_WKO_max;
			parameter<GJe_GJth> V_elek_TEO                := Eff_min * Efficiency/V_elek_TEO_min           + Eff_max * Efficiency/V_elek_TEO_max;
			parameter<ratio>    W_zonder_bijstook         := Eff_min * Efficiency/W_zonder_bijstook_min    + Eff_max * Efficiency/W_zonder_bijstook_max;
			parameter<ratio>    Vermogenverlies_LT        := Eff_min * Efficiency/Vermogenverlies_LT_min   + Eff_max * Efficiency/Vermogenverlies_LT_max;
			parameter<ratio>    Leidingverlies            := Eff_min * Efficiency/Leidingverlies_min       + Eff_max * Efficiency/Leidingverlies_max;
			parameter<ratio>    Pompenergie_Wnet          := Eff_min * Efficiency/Pompenergie_Wnet_min     + Eff_max * Efficiency/Pompenergie_Wnet_max;
			parameter<ratio>    Efficiency_piekketel      := Eff_min * Efficiency/Efficiency_piekketel_min + Eff_max * Efficiency/Efficiency_piekketel_max;
			parameter<float64>  HulpketelVermogensaandeel := Eff_min * Efficiency/HulpketelVermogens_min   + Eff_max * Efficiency/HulpketelVermogens_max;
			parameter<float64>  HoofdbronVermogensaandeel := Eff_min * Efficiency/HoofdbronVermogens_min   + Eff_max * Efficiency/HoofdbronVermogens_max;
			parameter<ratio>    Efficiency_ketel_optimaal := Eff_min * Efficiency/Eff_ketel_min            + Eff_max * Efficiency/Eff_ketel_max;
			parameter<ratio>    Vermogenverlies_MT        := Eff_min * Efficiency/Vermogenverlies_MT_min   + Eff_max * Efficiency/Vermogenverlies_MT_max;
		}

		template Efficiency_LT
		{
			//begin case parameters
			parameter<Celsius> T_ow;
			parameter<Celsius> T_sec;
			//end case parameters	
			
			parameter<float64>  AandeelPrimairVermogen :=                 0.30       , Descr = "Aandeel van het gevraagde vermogen dat door de primaire bron wordt geleverd";
			parameter<float64>  AandeelHulpVermogen    := T_ow == T_sec ? 0.70 : 1.00, Descr = "Aandeel van het gevraagde vermogen dat door de hulpvoorziening wordt geleverd";
			parameter<float64>  AandeelPrimairVolume   :=                 1.00       , Descr = "Aandeel van het gevraagde volume dat door de primaire bron wordt geleverd";
			parameter<float64>  AandeelHulpVolume      := T_ow == T_sec ? 0.30 : 1.00, Descr = "Aandeel van het gevraagde volume dat door de hulpvoorziening wordt geleverd";

			parameter<kW_GJ_yr> AandeelTEOVermogen     := 0.139[kW_GJ_yr]            , Descr = "Capaciteit waarop TEO wordt geschaald, bepaald op 2000 vollasturen";

			//Seasonal Performance Factors
			parameter<ratio> SPF_coll_W :=
				T_ow <= 20[Celsius] && T_sec <= 35[Celsius] ? 7.9 :                     // van 15 naar 30
					T_ow <= 20[Celsius] && T_sec <= 55[Celsius] ? 3.2 :                 // van 15 naar 50
						T_ow <= 20[Celsius] && T_sec <= 75[Celsius] ? 3.0 :             // van 15 naar 70
							T_ow <= 35[Celsius] && T_sec <= 35[Celsius] ? 7.9 :         // van 30 naar 30
								T_ow <= 35[Celsius] && T_sec <= 55[Celsius] ? 4.2 :     // van 30 naar 50
									T_ow <= 35[Celsius] && T_sec <= 75[Celsius] ? 3.2 : // van 30 naar 70
				1.0
				, Descr = "efficientie van de collectieve warmtepomp bij warmtelevering", Source = "Functioneel ontwerp 4.0 Bijlage A.6 Tabel 26";

			parameter<ratio>   SPF_coll_K     : [30]                                                             , Descr = "efficientie van de collectieve warmtepomp bij koudelevering";
			parameter<float64> SPF_ind_A_rv   := 8.0                                                             , Descr = "efficientie van de individuele warmtepomp voor ruimteverwarming, label A+";
			parameter<float64> SPF_ind_B_rv   := T_sec <= 35[Celsius] ? 4.20 : 8.0                               , Descr = "efficientie van de individuele warmtepomp voor ruimteverwarming, label B";
			parameter<float64> SPF_ind_CE_rv  := T_sec <= 35[Celsius] ? 3.20 :  T_sec <= 55[Celsius] ? 4.2 : 1.0 , Descr = "efficientie van de individuele warmtepomp voor ruimteverwarming, label C, D of E";
			parameter<float64> SPF_ind_tw     := T_sec <= 55[Celsius] ? 2.75 : 1.0                               , Descr = "efficientie van de individuele warmtepomp voor tapwaterverwarming";
			parameter<float64> SPF_booster_tw := T_sec <= 55[Celsius] ? 4.40 : 1.0                               , Descr = "efficientie van de individuele warmtepomp voor tapwaterverwarming";
			parameter<ratio>   SPF_ind_K      : [1]                                                              , Descr = "efficientie van een individuele warmtepomp bij koudelevering";

			// Aandeel eigen opwekking
			parameter<float64> AEO_ind_A_rv  := T_sec <= 35[Celsius] ? 0.6 : T_sec <= 55[Celsius] ? 0.3 : 0.0 , Descr = "Aandeel eigen opwekking, ruimteverwarming, label A+";
			parameter<float64> AEO_ind_B_rv  := T_sec <= 35[Celsius] ? 0.9 : T_sec <= 55[Celsius] ? 0.6 : 0.0 , Descr = "Aandeel eigen opwekking, ruimteverwarming, label B";
			parameter<float64> AEO_ind_CE_rv := T_sec <= 35[Celsius] ? 1.0 : T_sec <= 55[Celsius] ? 0.9 : 0.0 , Descr = "Aandeel eigen opwekking, ruimteverwarming, label C, D of E";
			parameter<float64> AEO_ind_tw    := T_sec <= 35[Celsius] ? 0.6 : T_sec <= 55[Celsius] ? 0.3 : 0.0 , Descr = "Aandeel eigen opwekking, warm tapwater";
			parameter<float64> AEO_ind_K     : [0.0]                                                          , Descr = "Aandeel eigen opwekking koude, relevant indien koude geleverd kan worden, 100% individuele opwekking indien niet geleverd en wel gevraagd zoals bij utiliteiten";		
		}
	}
	#include <Vermogens.dms>
	
	container Netbeheer :=
	for_each_nedvn(
		 src/Netbeheer/Naam
		,src/Netbeheer/waarde+"[" + src/Netbeheer/eenheid + "]"
		, void
		, src/Netbeheer
		, src/Netbeheer/eenheid
	), StorageReadOnly = "True"
	{
		template infrakosten : Source = "doc/Notitie wijzigingen Vesta MAIS model E en G infrastructuur"
		{
			//begin case parameters
			parameter<ratio> InfraCurve;
			parameter<ratio> KostenMin;
			parameter<ratio> KostenMax;
			//end case parameters

			//kentallen investeringen ingrepen e en g infra
			parameter<Eur_m>   Ki_verv_LD_len      := Infracurve * (KostenMin * Ki_verv_LD_min      + KostenMax * Ki_verv_LD_max);
			parameter<Eur_asl> Ki_verw_g_laagb_asl := Infracurve * (KostenMin * Ki_verw_g_laagb_min + KostenMax * Ki_verw_g_laagb_max);
			parameter<Eur_asl> Ki_verw_g_hoogb_asl := Infracurve * (KostenMin * Ki_verw_g_hoogb_min + KostenMax * Ki_verw_g_hoogb_max);
			parameter<Eur_asl> Ki_verw_g_util_asl  := Infracurve * (KostenMin * Ki_verw_g_util_min  + KostenMax * Ki_verw_g_util_max);
			parameter<Eur_m>   Ki_verw_LD_len      := Infracurve * (KostenMin * Ki_verw_LD_min      + KostenMax * Ki_verw_LD_max);
			parameter<Eur_asl> Ki_verzw_e_asl      := Infracurve * (KostenMin * Ki_verzw_e_min      + KostenMax * Ki_verzw_e_max);
			parameter<Eur_MSR> Ki_MSR              := Infracurve * (KostenMin * Ki_MSR_min          + KostenMax * Ki_MSR_max);
			parameter<Eur_m>   Ki_verzw_LS_len     := Infracurve * (KostenMin * Ki_verzw_LS_min     + KostenMax * Ki_verzw_LS_max);
			parameter<kW_MSR>  P_MSR               := P_MSR_kw;
		}
	}
	container Onderhoud: Source = "Functioneel ontwerp 4.0 Bijlage A.8 Tabel 30"
	{
		parameter<_yr> R_WOS_onderhoud    := 0.030[_yr] , Descr = "jaarlijkse onderhoudskosten warmteoverdrachtstations in warmtenetten";
		parameter<_yr> R_OS_onderhoud     := 0.030[_yr] , Descr = "jaarlijkse onderhoudskosten onderstations in warmtenetten";
		parameter<_yr> R_OS_admin         := 0.000[_yr] , Descr = "jaarlijkse administratiekosten onderstations in warmtenetten";
		parameter<_yr> R_Sec_onderhoud    := 0.010[_yr] , Descr = "jaarlijkse onderhoudskosten secundaire leidingen GLTB in warmtenetten";
		parameter<_yr> R_pt_onderhoud     := 0.010[_yr] , Descr = "jaarlijkse onderhoudskosten primaire transportleidingen in warmtenetten";
		parameter<_yr> R_pt_admin         := 0.000[_yr] , Descr = "jaarlijkse administratiekosten primaire transportleidingen in warmtenetten";
		parameter<_yr> R_Inst_onderhoud   := 0.030[_yr] , Descr = "jaarlijkse onderhoudskosten installaties in warmtenetten";
		parameter<_yr> R_Inst_admin       := 0.030[_yr] , Descr = "jaarlijkse administratiekosten installaties in warmtenetten";
		parameter<_yr> R_lv_Admin         := 0.010[_yr] , Descr = "Fractie van vastrecht dat de leveancier aan administratiekosten besteedt";
		parameter<_yr> R_id_onderhoud     := 0.025[_yr] , Descr = "jaarlijkse onderhoudskosten inpandige distributie als percentage van de initiele investering";
		parameter<_yr> R_id_admin         := 0.000[_yr] , Descr = "jaarlijkse administratiekosten inpandige distributie als percentage van de initiele investering";
		parameter<_yr> R_ow_onderhoud     := 0.050[_yr] , Descr = "jaarlijkse onderhoudskosten opwekking aan de bron als percentage van de initiele investering";
		parameter<_yr> R_ow_admin         := 0.025[_yr] , Descr = "jaarlijkse administratiekosten opwekking aan de bron als percentage van de initiele investering";
		parameter<_yr> R_wd_onderhoud     := 0.010[_yr] , Descr = "jaarlijkse onderhoudskosten wijkdistributie als percentage van de initiele investering";
		parameter<_yr> R_wd_admin         := 0.000[_yr] , Descr = "jaarlijkse administratiekosten wijkdistributie als percentage van de initiele investering";
		parameter<_yr> R_wpColl_onderhoud := 0.035[_yr] , Descr = "jaarlijkse onderhoudskostencollectieve warmtepomp als percentage van de initiele investering";
		parameter<_yr> R_wpColl_admin     := 0.025[_yr] , Descr = "jaarlijkse administratiekosten collectieve warmtepomp als percentage van de initiele investering";
		parameter<_yr> R_buffer_onderhoud := 0.025[_yr] , Descr = "jaarlijkse onderhoudskosten seizoensbuffer als percentage van de initiele investering";
		parameter<_yr> R_buffer_admin     := 0.025[_yr] , Descr = "jaarlijkse administratiekosten seizoensbuffer als percentage van de initiele investering";
		parameter<_yr> R_WKO_onderhoud    := 0.020[_yr] , Descr = "jaarlijkse onderhoudskosten WKO systemen als percentage van de initiele investering";
		parameter<_yr> R_WKO_admin        := 0.000[_yr] , Descr = "jaarlijkse administratiekosten WKO systemen als percentage van de initiele investering";
		parameter<_yr> R_TEO_onderhoud    := 0.030[_yr] , Descr = "jaarlijkse onderhoudskosten TEO systemen als percentage van de initiele investering";
		parameter<_yr> R_TEO_admin        := 0.000[_yr] , Descr = "jaarlijkse administratiekosten TEO systemen als percentage van de initiele investering";
	}
}
